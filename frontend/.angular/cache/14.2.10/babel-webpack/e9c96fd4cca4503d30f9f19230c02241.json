{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/kosov/OneDrive/Dokumenti/UredjivanjeProstoraAPP/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { Korisnik } from '../models/korisnik';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/korisnik.service\";\nimport * as i2 from \"../services/mejl.service\";\nimport * as i3 from \"@angular/router\";\nexport class PromenaLozinkeComponent {\n  constructor(korisnikServis, mejlServis, ruter) {\n    this.korisnikServis = korisnikServis;\n    this.mejlServis = mejlServis;\n    this.ruter = ruter;\n    this.korisnik = new Korisnik();\n    this.privremeneLozinke = [];\n    this.greska = '';\n  }\n\n  ngOnInit() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      let korisnickoIme = sessionStorage.getItem('korisnik');\n      _this.privremeneLozinke = yield _this.mejlServis.dohvatiPrivremeneLozinke(korisnickoIme);\n\n      _this.korisnikServis.dohvatiKorisnika(korisnickoIme).subscribe(korisnik => {\n        _this.korisnik = korisnik;\n      });\n    })();\n  }\n\n  promeniLozinku() {\n    if (this.staraLozinka != this.korisnik.lozinka) {\n      for (const privremena of this.privremeneLozinke) {\n        if (privremena.lozinka == this.staraLozinka) {\n          break;\n        }\n      }\n\n      this.greska = 'Uneta stara lozinka nije ispravna';\n      return;\n    } else if (this.novaLozinka != this.potvrdaNoveLozinke) {\n      this.greska = 'Unete lozinke se ne poklapaju';\n      return;\n    } else if (this.novaLozinka == this.staraLozinka) {\n      this.greska = 'Nova lozinka ne sme biti ista kao stara';\n      return;\n    } else {\n      this.korisnikServis.azurirajLozinku(this.korisnik.korisnickoIme, this.novaLozinka).subscribe(res => {\n        alert('Lozinka uspesno promenjena!');\n        sessionStorage.clear();\n        this.ruter.navigate(['/']);\n      });\n    }\n  }\n\n}\n\nPromenaLozinkeComponent.ɵfac = function PromenaLozinkeComponent_Factory(t) {\n  return new (t || PromenaLozinkeComponent)(i0.ɵɵdirectiveInject(i1.KorisnikService), i0.ɵɵdirectiveInject(i2.MejlService), i0.ɵɵdirectiveInject(i3.Router));\n};\n\nPromenaLozinkeComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: PromenaLozinkeComponent,\n  selectors: [[\"app-promena-lozinke\"]],\n  decls: 2,\n  vars: 0,\n  template: function PromenaLozinkeComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"p\");\n      i0.ɵɵtext(1, \"promena-lozinke works!\");\n      i0.ɵɵelementEnd();\n    }\n  },\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJwcm9tZW5hLWxvemlua2UuY29tcG9uZW50LmNzcyJ9 */\"]\n});","map":{"version":3,"mappings":";AAEA,SAASA,QAAT,QAAyB,oBAAzB;;;;;AAUA,OAAM,MAAOC,uBAAP,CAA8B;EAClCC,YACUC,cADV,EAEUC,UAFV,EAGUC,KAHV,EAGuB;IAFb;IACA;IACA;IAyCV,gBAAqB,IAAIL,QAAJ,EAArB;IACA,yBAAyC,EAAzC;IAMA,cAAiB,EAAjB;EA/CI;;EAEEM,QAAQ;IAAA;;IAAA;MACZ,IAAIC,aAAa,GAAGC,cAAc,CAACC,OAAf,CAAuB,UAAvB,CAApB;MACA,KAAI,CAACC,iBAAL,SAA+B,KAAI,CAACN,UAAL,CAAgBO,wBAAhB,CAC7BJ,aAD6B,CAA/B;;MAGA,KAAI,CAACJ,cAAL,CACGS,gBADH,CACoBL,aADpB,EAEGM,SAFH,CAEcC,QAAD,IAAuB;QAChC,KAAI,CAACA,QAAL,GAAgBA,QAAhB;MACD,CAJH;IALY;EAUb;;EAEDC,cAAc;IACZ,IAAI,KAAKC,YAAL,IAAqB,KAAKF,QAAL,CAAcG,OAAvC,EAAgD;MAC9C,KAAK,MAAMC,UAAX,IAAyB,KAAKR,iBAA9B,EAAiD;QAC/C,IAAIQ,UAAU,CAACD,OAAX,IAAsB,KAAKD,YAA/B,EAA6C;UAC3C;QACD;MACF;;MACD,KAAKG,MAAL,GAAc,mCAAd;MACA;IACD,CARD,MAQO,IAAI,KAAKC,WAAL,IAAoB,KAAKC,kBAA7B,EAAiD;MACtD,KAAKF,MAAL,GAAc,+BAAd;MACA;IACD,CAHM,MAGA,IAAI,KAAKC,WAAL,IAAoB,KAAKJ,YAA7B,EAA2C;MAChD,KAAKG,MAAL,GAAc,yCAAd;MACA;IACD,CAHM,MAGA;MACL,KAAKhB,cAAL,CACGmB,eADH,CACmB,KAAKR,QAAL,CAAcP,aADjC,EACgD,KAAKa,WADrD,EAEGP,SAFH,CAEcU,GAAD,IAAQ;QACjBC,KAAK,CAAC,6BAAD,CAAL;QACAhB,cAAc,CAACiB,KAAf;QACA,KAAKpB,KAAL,CAAWqB,QAAX,CAAoB,CAAC,GAAD,CAApB;MACD,CANH;IAOD;EACF;;AA3CiC;;;mBAAvBzB,yBAAuB0B;AAAA;;;QAAvB1B;EAAuB2B;EAAAC;EAAAC;EAAAC;IAAA;MCZpCJ;MAAGA;MAAsBA","names":["Korisnik","PromenaLozinkeComponent","constructor","korisnikServis","mejlServis","ruter","ngOnInit","korisnickoIme","sessionStorage","getItem","privremeneLozinke","dohvatiPrivremeneLozinke","dohvatiKorisnika","subscribe","korisnik","promeniLozinku","staraLozinka","lozinka","privremena","greska","novaLozinka","potvrdaNoveLozinke","azurirajLozinku","res","alert","clear","navigate","i0","selectors","decls","vars","template"],"sourceRoot":"","sources":["C:\\Users\\kosov\\OneDrive\\Dokumenti\\UredjivanjeProstoraAPP\\frontend\\src\\app\\promena-lozinke\\promena-lozinke.component.ts","C:\\Users\\kosov\\OneDrive\\Dokumenti\\UredjivanjeProstoraAPP\\frontend\\src\\app\\promena-lozinke\\promena-lozinke.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { KorisnikService } from '../services/korisnik.service';\nimport { Korisnik } from '../models/korisnik';\nimport { PrivremenaLozinka } from '../models/privremenaLozinka';\nimport { MejlService } from '../services/mejl.service';\nimport { Router } from '@angular/router';\n\n@Component({\n  selector: 'app-promena-lozinke',\n  templateUrl: './promena-lozinke.component.html',\n  styleUrls: ['./promena-lozinke.component.css'],\n})\nexport class PromenaLozinkeComponent implements OnInit {\n  constructor(\n    private korisnikServis: KorisnikService,\n    private mejlServis: MejlService,\n    private ruter: Router\n  ) {}\n\n  async ngOnInit() {\n    let korisnickoIme = sessionStorage.getItem('korisnik');\n    this.privremeneLozinke = await this.mejlServis.dohvatiPrivremeneLozinke(\n      korisnickoIme\n    );\n    this.korisnikServis\n      .dohvatiKorisnika(korisnickoIme)\n      .subscribe((korisnik: Korisnik) => {\n        this.korisnik = korisnik;\n      });\n  }\n\n  promeniLozinku() {\n    if (this.staraLozinka != this.korisnik.lozinka) {\n      for (const privremena of this.privremeneLozinke) {\n        if (privremena.lozinka == this.staraLozinka) {\n          break;\n        }\n      }\n      this.greska = 'Uneta stara lozinka nije ispravna';\n      return;\n    } else if (this.novaLozinka != this.potvrdaNoveLozinke) {\n      this.greska = 'Unete lozinke se ne poklapaju';\n      return;\n    } else if (this.novaLozinka == this.staraLozinka) {\n      this.greska = 'Nova lozinka ne sme biti ista kao stara';\n      return;\n    } else {\n      this.korisnikServis\n        .azurirajLozinku(this.korisnik.korisnickoIme, this.novaLozinka)\n        .subscribe((res) => {\n          alert('Lozinka uspesno promenjena!');\n          sessionStorage.clear();\n          this.ruter.navigate(['/']);\n        });\n    }\n  }\n\n  korisnik: Korisnik = new Korisnik();\n  privremeneLozinke: PrivremenaLozinka[] = [];\n\n  staraLozinka: string;\n  novaLozinka: string;\n  potvrdaNoveLozinke: string;\n\n  greska: string = '';\n}\n","<p>promena-lozinke works!</p>\n"]},"metadata":{},"sourceType":"module"}
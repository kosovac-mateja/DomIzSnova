{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/kosov/OneDrive/Dokumenti/UredjivanjeProstoraAPP/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/mejl.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"../services/agencija.service\";\nimport * as i4 from \"../services/klijent.service\";\nimport * as i5 from \"@angular/forms\";\nexport class ZaboravljenaLozinkaComponent {\n  constructor(mejlServis, ruter, agencijaServis, klijentServis) {\n    this.mejlServis = mejlServis;\n    this.ruter = ruter;\n    this.agencijaServis = agencijaServis;\n    this.klijentServis = klijentServis;\n    this.greska = '';\n  }\n\n  ngOnInit() {}\n\n  resetuj() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      if (_this.mejl != _this.mejlPotvrda) {\n        _this.greska = 'Mejl adrese se ne poklapaju!';\n        return;\n      }\n\n      let korisnickoIme = '';\n      yield _this.klijentServis.mejlPostoji(_this.mejl).subscribe(res => {\n        console.log(res);\n\n        if (res['postoji'] == 'da') {\n          _this.klijentServis.dohvatiKlijentaPoMejlu(_this.mejl).subscribe(klijent => {\n            korisnickoIme = klijent.korisnickoIme;\n          });\n        }\n      });\n      yield _this.agencijaServis.mejlPostoji(_this.mejl).subscribe(res => {\n        console.log(res);\n\n        if (res['postoji'] == 'da') {\n          _this.agencijaServis.dohvatiAgencijuPoMejlu(_this.mejl).subscribe(agencija => {\n            korisnickoIme = agencija.korisnickoIme;\n          });\n        }\n      });\n      console.log(korisnickoIme + 'kurcina');\n\n      if (korisnickoIme == '') {\n        _this.greska = 'Mejl adresa ne postoji!';\n        return;\n      }\n\n      _this.mejlServis.posaljiMejl(_this.mejl).subscribe(res => {\n        if (res['poruka'] != 'ok') {\n          _this.greska = 'Greska prilikom slanja mejla!';\n          return;\n        }\n      });\n\n      _this.mejlServis.ubaciPrivremenuLozinku(korisnickoIme).subscribe(res => {\n        if (res['poruka'] == 'ok') {\n          alert('Poslat je mejl sa privremenom lozinkom!');\n        } else {\n          alert('Greska prilikom slanja mejla!');\n        }\n      });\n\n      _this.ruter.navigate(['/prijava']);\n    })();\n  }\n\n}\n\nZaboravljenaLozinkaComponent.ɵfac = function ZaboravljenaLozinkaComponent_Factory(t) {\n  return new (t || ZaboravljenaLozinkaComponent)(i0.ɵɵdirectiveInject(i1.MejlService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.AgencijaService), i0.ɵɵdirectiveInject(i4.KlijentService));\n};\n\nZaboravljenaLozinkaComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: ZaboravljenaLozinkaComponent,\n  selectors: [[\"app-zaboravljena-lozinka\"]],\n  decls: 18,\n  vars: 3,\n  consts: [[\"type\", \"text\", \"name\", \"mejl\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"text\", \"name\", \"mejlPotvrda\", 3, \"ngModel\", \"ngModelChange\"], [\"colspan\", \"2\"], [3, \"click\"]],\n  template: function ZaboravljenaLozinkaComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"h3\");\n      i0.ɵɵtext(1, \"Zaboravljena lozinka\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(2, \"table\")(3, \"tr\")(4, \"td\");\n      i0.ɵɵtext(5, \"Mejl adresa\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(6, \"td\")(7, \"input\", 0);\n      i0.ɵɵlistener(\"ngModelChange\", function ZaboravljenaLozinkaComponent_Template_input_ngModelChange_7_listener($event) {\n        return ctx.mejl = $event;\n      });\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(8, \"tr\")(9, \"td\");\n      i0.ɵɵtext(10, \"Potvrda mejl adrese\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(11, \"td\")(12, \"input\", 1);\n      i0.ɵɵlistener(\"ngModelChange\", function ZaboravljenaLozinkaComponent_Template_input_ngModelChange_12_listener($event) {\n        return ctx.mejlPotvrda = $event;\n      });\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(13, \"tr\")(14, \"td\", 2)(15, \"button\", 3);\n      i0.ɵɵlistener(\"click\", function ZaboravljenaLozinkaComponent_Template_button_click_15_listener() {\n        return ctx.resetuj();\n      });\n      i0.ɵɵtext(16, \"Posalji\");\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵtext(17);\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"ngModel\", ctx.mejl);\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngModel\", ctx.mejlPotvrda);\n      i0.ɵɵadvance(5);\n      i0.ɵɵtextInterpolate1(\"\\n\", ctx.greska, \"\\n\");\n    }\n  },\n  dependencies: [i5.DefaultValueAccessor, i5.NgControlStatus, i5.NgModel],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJ6YWJvcmF2bGplbmEtbG96aW5rYS5jb21wb25lbnQuY3NzIn0= */\"]\n});","map":{"version":3,"mappings":"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","names":["ZaboravljenaLozinkaComponent","constructor","mejlServis","ruter","agencijaServis","klijentServis","ngOnInit","resetuj","mejl","mejlPotvrda","greska","korisnickoIme","mejlPostoji","subscribe","res","console","log","dohvatiKlijentaPoMejlu","klijent","dohvatiAgencijuPoMejlu","agencija","posaljiMejl","ubaciPrivremenuLozinku","alert","navigate","i0","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\Users\\kosov\\OneDrive\\Dokumenti\\UredjivanjeProstoraAPP\\frontend\\src\\app\\zaboravljena-lozinka\\zaboravljena-lozinka.component.ts","C:\\Users\\kosov\\OneDrive\\Dokumenti\\UredjivanjeProstoraAPP\\frontend\\src\\app\\zaboravljena-lozinka\\zaboravljena-lozinka.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { MejlService } from '../services/mejl.service';\nimport { Router } from '@angular/router';\nimport { AgencijaService } from '../services/agencija.service';\nimport { KlijentService } from '../services/klijent.service';\nimport { Klijent } from '../models/klijent';\nimport { Agencija } from '../models/agencija';\n\n@Component({\n  selector: 'app-zaboravljena-lozinka',\n  templateUrl: './zaboravljena-lozinka.component.html',\n  styleUrls: ['./zaboravljena-lozinka.component.css'],\n})\nexport class ZaboravljenaLozinkaComponent implements OnInit {\n  constructor(\n    private mejlServis: MejlService,\n    private ruter: Router,\n    private agencijaServis: AgencijaService,\n    private klijentServis: KlijentService\n  ) {}\n\n  ngOnInit(): void {}\n\n  async resetuj() {\n    if (this.mejl != this.mejlPotvrda) {\n      this.greska = 'Mejl adrese se ne poklapaju!';\n      return;\n    }\n\n    let korisnickoIme = '';\n\n    await this.klijentServis.mejlPostoji(this.mejl).subscribe((res) => {\n      console.log(res);\n      if (res['postoji'] == 'da') {\n        this.klijentServis\n          .dohvatiKlijentaPoMejlu(this.mejl)\n          .subscribe((klijent: Klijent) => {\n            korisnickoIme = klijent.korisnickoIme;\n          });\n      }\n    });\n\n    await this.agencijaServis.mejlPostoji(this.mejl).subscribe((res) => {\n      console.log(res);\n      if (res['postoji'] == 'da') {\n        this.agencijaServis\n          .dohvatiAgencijuPoMejlu(this.mejl)\n          .subscribe((agencija: Agencija) => {\n            korisnickoIme = agencija.korisnickoIme;\n          });\n      }\n    });\n\n    console.log(korisnickoIme + 'kurcina');\n\n    if (korisnickoIme == '') {\n      this.greska = 'Mejl adresa ne postoji!';\n      return;\n    }\n\n    this.mejlServis.posaljiMejl(this.mejl).subscribe((res) => {\n      if (res['poruka'] != 'ok') {\n        this.greska = 'Greska prilikom slanja mejla!';\n        return;\n      }\n    });\n    this.mejlServis.ubaciPrivremenuLozinku(korisnickoIme).subscribe((res) => {\n      if (res['poruka'] == 'ok') {\n        alert('Poslat je mejl sa privremenom lozinkom!');\n      } else {\n        alert('Greska prilikom slanja mejla!');\n      }\n    });\n    this.ruter.navigate(['/prijava']);\n  }\n\n  mejl: string;\n  mejlPotvrda: string;\n  greska: string = '';\n}\n","<h3>Zaboravljena lozinka</h3>\n\n<table>\n    <tr>\n        <td>Mejl adresa</td>\n        <td><input type=\"text\" name=\"mejl\" [(ngModel)]=\"mejl\"></td>\n    </tr>\n    <tr>\n        <td>Potvrda mejl adrese</td>\n        <td><input type=\"text\" name=\"mejlPotvrda\" [(ngModel)]=\"mejlPotvrda\"></td>\n    </tr>\n    <tr>\n        <td colspan=\"2\"><button (click)=\"resetuj()\">Posalji</button></td>\n    </tr>\n</table>\n{{greska}}\n"]},"metadata":{},"sourceType":"module"}
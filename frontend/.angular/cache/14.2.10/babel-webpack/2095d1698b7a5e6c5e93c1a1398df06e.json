{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/kosov/OneDrive/Dokumenti/UredjivanjeProstoraAPP/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/korisnik.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"../services/mejl.service\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"../zaglavlje-pocetna/zaglavlje-pocetna.component\";\n\nconst _c0 = function () {\n  return [\"/zaboravljenaLozinka\"];\n};\n\nconst _c1 = function () {\n  return [\"/registracija\"];\n};\n\nexport class PrijavaComponent {\n  constructor(korisnikServis, ruter, mejlServis) {\n    this.korisnikServis = korisnikServis;\n    this.ruter = ruter;\n    this.mejlServis = mejlServis;\n    this.korisnickoIme = '';\n    this.lozinka = '';\n    this.privLozinke = [];\n    this.greska = '';\n  }\n\n  ngOnInit() {}\n\n  prijava() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      if (_this.korisnickoIme == '' || _this.lozinka == '') {\n        _this.greska = 'Niste uneli sve podatke';\n        return;\n      }\n\n      _this.privLozinke = yield _this.mejlServis.dohvatiPrivremeneLozinke(_this.korisnickoIme);\n\n      _this.korisnikServis.dohvatiKorisnika(_this.korisnickoIme).subscribe(korisnik => {\n        _this.korisnik = korisnik;\n\n        if (_this.korisnik == undefined) {\n          _this.greska = 'Ne postoji korisnik sa unetim korisnickim imenom';\n          return;\n        }\n\n        if (korisnik.status != 'prihvacen') {\n          _this.greska = 'Vas zahtev za registraciju jos uvek nije prihvacen';\n          return;\n        }\n\n        if (_this.korisnik.lozinka != _this.lozinka) {\n          if (_this.privLozinke == null || _this.privLozinke.find(pl => pl.lozinka == _this.lozinka) == null || new Date(_this.privLozinke.find(pl => pl.lozinka == _this.lozinka).vremeIsteka) < new Date()) {\n            _this.greska = 'Pogresna lozinka';\n            return;\n          }\n        }\n\n        if (_this.korisnik.tip == 'klijent') {\n          sessionStorage.setItem('korisnik', _this.korisnik.korisnickoIme);\n\n          _this.ruter.navigate(['/klijent/agencije']);\n        } else if (_this.korisnik.tip == 'agencija') {\n          sessionStorage.setItem('korisnik', _this.korisnik.korisnickoIme);\n\n          _this.ruter.navigate(['/agencija/poslovi']);\n        }\n      });\n    })();\n  }\n\n}\n\nPrijavaComponent.ɵfac = function PrijavaComponent_Factory(t) {\n  return new (t || PrijavaComponent)(i0.ɵɵdirectiveInject(i1.KorisnikService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.MejlService));\n};\n\nPrijavaComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: PrijavaComponent,\n  selectors: [[\"app-prijava\"]],\n  decls: 28,\n  vars: 7,\n  consts: [[1, \"container\"], [1, \"row\", \"justify-content-center\"], [1, \"col-lg-4\", \"col-md-6\", \"col-sm-8\"], [1, \"text-center\"], [1, \"card\"], [1, \"card-body\"], [1, \"form-group\"], [\"for\", \"korisnickoIme\"], [\"type\", \"text\", \"name\", \"korisnickoIme\", \"id\", \"korisnickoIme\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"lozinka\"], [\"type\", \"password\", \"name\", \"lozinka\", \"id\", \"lozinka\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [1, \"form-group\", \"text-center\"], [1, \"forgot-password-link\", 3, \"routerLink\"], [1, \"btn\", \"btn-primary\", 3, \"click\"], [1, \"text-center\", \"mt-3\"], [3, \"routerLink\"], [1, \"text-center\", \"text-danger\"]],\n  template: function PrijavaComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelement(0, \"app-zaglavlje-pocetna\");\n      i0.ɵɵelementStart(1, \"div\", 0)(2, \"div\", 1)(3, \"div\", 2)(4, \"h1\", 3);\n      i0.ɵɵtext(5, \"Prijavi se\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(6, \"div\", 4)(7, \"div\", 5)(8, \"div\", 6)(9, \"label\", 7);\n      i0.ɵɵtext(10, \"Korisni\\u010Dko ime\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(11, \"input\", 8);\n      i0.ɵɵlistener(\"ngModelChange\", function PrijavaComponent_Template_input_ngModelChange_11_listener($event) {\n        return ctx.korisnickoIme = $event;\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(12, \"div\", 6)(13, \"label\", 9);\n      i0.ɵɵtext(14, \"Lozinka\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(15, \"input\", 10);\n      i0.ɵɵlistener(\"ngModelChange\", function PrijavaComponent_Template_input_ngModelChange_15_listener($event) {\n        return ctx.lozinka = $event;\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(16, \"div\", 11)(17, \"a\", 12);\n      i0.ɵɵtext(18, \"Zaboravljena lozinka?\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(19, \"div\", 11)(20, \"button\", 13);\n      i0.ɵɵlistener(\"click\", function PrijavaComponent_Template_button_click_20_listener() {\n        return ctx.prijava();\n      });\n      i0.ɵɵtext(21, \"Prijava\");\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(22, \"div\", 14);\n      i0.ɵɵtext(23, \" Niste prijavljeni? \");\n      i0.ɵɵelementStart(24, \"a\", 15);\n      i0.ɵɵtext(25, \"Registruj se\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(26, \"div\", 16);\n      i0.ɵɵtext(27);\n      i0.ɵɵelementEnd()()()();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(11);\n      i0.ɵɵproperty(\"ngModel\", ctx.korisnickoIme);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngModel\", ctx.lozinka);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(5, _c0));\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(6, _c1));\n      i0.ɵɵadvance(3);\n      i0.ɵɵtextInterpolate(ctx.greska);\n    }\n  },\n  dependencies: [i2.RouterLinkWithHref, i4.DefaultValueAccessor, i4.NgControlStatus, i4.NgModel, i5.ZaglavljePocetnaComponent],\n  styles: [\"body[_ngcontent-%COMP%] {\\n  background-color: #f8f9fa;\\n}\\n\\n.container[_ngcontent-%COMP%] {\\n  margin-top: 100px;\\n}\\n\\n.card[_ngcontent-%COMP%] {\\n  border: none;\\n  box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);\\n}\\n\\nh1[_ngcontent-%COMP%] {\\n  font-size: 24px;\\n  font-weight: bold;\\n  margin-bottom: 20px;\\n}\\n\\n.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] {\\n  font-weight: bold;\\n}\\n\\n.form-group.text-center[_ngcontent-%COMP%] {\\n  display: flex;\\n  justify-content: space-between;\\n  align-items: center;\\n}\\n\\n.forgot-password-link[_ngcontent-%COMP%] {\\n  font-size: 14px;\\n  margin-left: auto;\\n}\\n\\n.btn-primary[_ngcontent-%COMP%] {\\n  width: 100%;\\n  background-color: lightblue;\\n  color: black;\\n  border-color: black;\\n}\\n\\n.text-danger[_ngcontent-%COMP%] {\\n  font-size: 14px;\\n}\\n\\n.text-center[_ngcontent-%COMP%] {\\n  text-align: center;\\n}\\n\\n.mt-3[_ngcontent-%COMP%] {\\n  margin-top: 15px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByaWphdmEuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLHlCQUF5QjtBQUMzQjs7QUFFQTtFQUNFLGlCQUFpQjtBQUNuQjs7QUFFQTtFQUNFLFlBQVk7RUFDWiwyQ0FBMkM7QUFDN0M7O0FBRUE7RUFDRSxlQUFlO0VBQ2YsaUJBQWlCO0VBQ2pCLG1CQUFtQjtBQUNyQjs7QUFFQTtFQUNFLGlCQUFpQjtBQUNuQjs7QUFFQTtFQUNFLGFBQWE7RUFDYiw4QkFBOEI7RUFDOUIsbUJBQW1CO0FBQ3JCOztBQUVBO0VBQ0UsZUFBZTtFQUNmLGlCQUFpQjtBQUNuQjs7QUFHQTtFQUNFLFdBQVc7RUFDWCwyQkFBMkI7RUFDM0IsWUFBWTtFQUNaLG1CQUFtQjtBQUNyQjs7QUFFQTtFQUNFLGVBQWU7QUFDakI7O0FBRUE7RUFDRSxrQkFBa0I7QUFDcEI7O0FBRUE7RUFDRSxnQkFBZ0I7QUFDbEIiLCJmaWxlIjoicHJpamF2YS5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiYm9keSB7XG4gIGJhY2tncm91bmQtY29sb3I6ICNmOGY5ZmE7XG59XG5cbi5jb250YWluZXIge1xuICBtYXJnaW4tdG9wOiAxMDBweDtcbn1cblxuLmNhcmQge1xuICBib3JkZXI6IG5vbmU7XG4gIGJveC1zaGFkb3c6IDBweCAwcHggMTBweCByZ2JhKDAsIDAsIDAsIDAuMSk7XG59XG5cbmgxIHtcbiAgZm9udC1zaXplOiAyNHB4O1xuICBmb250LXdlaWdodDogYm9sZDtcbiAgbWFyZ2luLWJvdHRvbTogMjBweDtcbn1cblxuLmZvcm0tZ3JvdXAgbGFiZWwge1xuICBmb250LXdlaWdodDogYm9sZDtcbn1cblxuLmZvcm0tZ3JvdXAudGV4dC1jZW50ZXIge1xuICBkaXNwbGF5OiBmbGV4O1xuICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG59XG5cbi5mb3Jnb3QtcGFzc3dvcmQtbGluayB7XG4gIGZvbnQtc2l6ZTogMTRweDtcbiAgbWFyZ2luLWxlZnQ6IGF1dG87XG59XG5cblxuLmJ0bi1wcmltYXJ5IHtcbiAgd2lkdGg6IDEwMCU7XG4gIGJhY2tncm91bmQtY29sb3I6IGxpZ2h0Ymx1ZTtcbiAgY29sb3I6IGJsYWNrO1xuICBib3JkZXItY29sb3I6IGJsYWNrO1xufVxuXG4udGV4dC1kYW5nZXIge1xuICBmb250LXNpemU6IDE0cHg7XG59XG5cbi50ZXh0LWNlbnRlciB7XG4gIHRleHQtYWxpZ246IGNlbnRlcjtcbn1cblxuLm10LTMge1xuICBtYXJnaW4tdG9wOiAxNXB4O1xufVxuIl19 */\"]\n});","map":{"version":3,"mappings":"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","names":["PrijavaComponent","constructor","korisnikServis","ruter","mejlServis","ngOnInit","prijava","korisnickoIme","lozinka","greska","privLozinke","dohvatiPrivremeneLozinke","dohvatiKorisnika","subscribe","korisnik","undefined","status","find","pl","Date","vremeIsteka","tip","sessionStorage","setItem","navigate","i0","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\Users\\kosov\\OneDrive\\Dokumenti\\UredjivanjeProstoraAPP\\frontend\\src\\app\\prijava\\prijava.component.ts","C:\\Users\\kosov\\OneDrive\\Dokumenti\\UredjivanjeProstoraAPP\\frontend\\src\\app\\prijava\\prijava.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { Korisnik } from '../models/korisnik';\nimport { KorisnikService } from '../services/korisnik.service';\nimport { Router } from '@angular/router';\nimport { MejlService } from '../services/mejl.service';\nimport { PrivremenaLozinka } from '../models/privremenaLozinka';\n\n@Component({\n  selector: 'app-prijava',\n  templateUrl: './prijava.component.html',\n  styleUrls: ['./prijava.component.css'],\n})\nexport class PrijavaComponent implements OnInit {\n  constructor(\n    private korisnikServis: KorisnikService,\n    private ruter: Router,\n    private mejlServis: MejlService\n  ) {}\n\n  ngOnInit(): void {}\n\n  async prijava() {\n    if (this.korisnickoIme == '' || this.lozinka == '') {\n      this.greska = 'Niste uneli sve podatke';\n      return;\n    }\n\n    this.privLozinke = await this.mejlServis.dohvatiPrivremeneLozinke(\n      this.korisnickoIme\n    );\n\n    this.korisnikServis\n      .dohvatiKorisnika(this.korisnickoIme)\n      .subscribe((korisnik: Korisnik) => {\n        this.korisnik = korisnik;\n        if (this.korisnik == undefined) {\n          this.greska = 'Ne postoji korisnik sa unetim korisnickim imenom';\n          return;\n        }\n\n        if (korisnik.status != 'prihvacen') {\n          this.greska = 'Vas zahtev za registraciju jos uvek nije prihvacen';\n          return;\n        }\n\n        if (this.korisnik.lozinka != this.lozinka) {\n          if (\n            this.privLozinke == null ||\n            this.privLozinke.find((pl) => pl.lozinka == this.lozinka) == null ||\n            new Date(\n              this.privLozinke.find(\n                (pl) => pl.lozinka == this.lozinka\n              ).vremeIsteka\n            ) < new Date()\n          ) {\n            this.greska = 'Pogresna lozinka';\n            return;\n          }\n        }\n\n        if (this.korisnik.tip == 'klijent') {\n          sessionStorage.setItem('korisnik', this.korisnik.korisnickoIme);\n          this.ruter.navigate(['/klijent/agencije']);\n        } else if (this.korisnik.tip == 'agencija') {\n          sessionStorage.setItem('korisnik', this.korisnik.korisnickoIme);\n          this.ruter.navigate(['/agencija/poslovi']);\n        }\n      });\n  }\n\n  korisnickoIme: string = '';\n  lozinka: string = '';\n  korisnik: Korisnik;\n\n  privLozinke: PrivremenaLozinka[] = [];\n\n  greska: string = '';\n}\n","<app-zaglavlje-pocetna></app-zaglavlje-pocetna>\n<div class=\"container\">\n  <div class=\"row justify-content-center\">\n    <div class=\"col-lg-4 col-md-6 col-sm-8\">\n      <h1 class=\"text-center\">Prijavi se</h1>\n      <div class=\"card\">\n        <div class=\"card-body\">\n          <div class=\"form-group\">\n            <label for=\"korisnickoIme\">Korisničko ime</label>\n            <input type=\"text\" class=\"form-control\" name=\"korisnickoIme\" id=\"korisnickoIme\" [(ngModel)]=\"korisnickoIme\">\n          </div>\n          <div class=\"form-group\">\n            <label for=\"lozinka\">Lozinka</label>\n            <input type=\"password\" class=\"form-control\" name=\"lozinka\" id=\"lozinka\" [(ngModel)]=\"lozinka\">\n          </div>\n          <div class=\"form-group text-center\">\n            <a class=\"forgot-password-link\" [routerLink]=\"['/zaboravljenaLozinka']\">Zaboravljena lozinka?</a>\n          </div>\n          <div class=\"form-group text-center\">\n            <button class=\"btn btn-primary\" (click)=\"prijava()\">Prijava</button>\n          </div>\n        </div>\n      </div>\n      <div class=\"text-center mt-3\">\n        Niste prijavljeni? <a [routerLink]=\"['/registracija']\">Registruj se</a>\n      </div>\n      <div class=\"text-center text-danger\">{{ greska }}</div>\n    </div>\n  </div>\n</div>\n"]},"metadata":{},"sourceType":"module"}